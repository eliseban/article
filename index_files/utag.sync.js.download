//tealium universal tag - utag.sync ut4.0.202303280505, Copyright 2023 Tealium.com Inc. All Rights Reserved.
try{try{(function(){window.utag_data=window.utag_data||{};var cookieRead=function(name){var nameEQ=name+"=";var ca=document.cookie.split(';');for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)===' '){c=c.substring(1,c.length);}
if(c.indexOf(nameEQ)===0){return c.substring(nameEQ.length,c.length);}}
return null;};var log=function(){if(window.location.href.indexOf("ad_test_debug=1")>-1||(window.localStorage&&window.localStorage.ad_test_debug==="1")){window.utag_data.ad_console_debug=true;}
if(window.utag_data.ad_console_debug&&window.console!=='undefined'){console.log.apply(window.console,Array.prototype.slice.call(arguments));}};var logUserStatus=function(){log("utag_data.pc_memtype: "+window.utag_data.pc_memtype+"\nutag_data.pc_pcsid: "+window.utag_data.pc_pcsid);}
var site_name=window.location.href.split('.')[1].replace('sit','').replace('uat','');var authData={site:(site_name==='news')?'newscomau':(site_name==='sn')?'skynews':site_name};function initRampartSync(){var rampart=new Rampart(authData);return rampart;}
var rampartToken=cookieRead('rampart_token');var subscriberToken=cookieRead('subscriber_token');var getAuth0LoginDefaults=function(){var think_id='';var subId='';var subProvider='';var authProvider='';var authProviderRemap={"facebook":"facebook.com","twitter":"twitter.com","google-oauth2":"google.com","linkedin":"linkedin.com","auth0":""};var memtype=window.utag_data.pc_memtype||window.utag_data.pcmemtype||'anonymous';var getAuth0JSON=function(payload){try{var payloadDecoded=atob(payload.replace(/-/g,"+").replace(/_/g,"/"));return JSON.parse(payloadDecoded);}catch(err){return false;}};if(rampartToken&&rampartToken.indexOf('.')>-1){var payload=rampartToken.split('.')[1];var auth0=getAuth0JSON(payload);think_id=auth0['http://login.newscorpaustralia.com.au/profile']?auth0['http://login.newscorpaustralia.com.au/profile'].think_id:'';authProvider=auth0['http://login.newscorpaustralia.com.au/profile']?auth0['http://login.newscorpaustralia.com.au/profile'].authProvider:'';authProvider=(authProvider in authProviderRemap)?authProviderRemap[authProvider]:authProvider;subId=auth0.sub.split("|")[1];subProvider=auth0.sub.split("|")[0];}
if(subscriberToken&&rampartToken){var entitlements=JSON.parse(decodeURI(subscriberToken));memtype=entitlements.entitlements?'subscriber':'registered';}else if(rampartToken){memtype='registered';}
return{think_id:think_id,memtype:memtype,authProvider:authProvider,subId,subProvider};};if(typeof Rampart!==undefined){log('Rampart.js loaded.');if(!rampartToken){log('No Rampart token cookie present. Getting user status from Rampart API.');auth=initRampartSync();auth.getLoginStatus().then(function(response){if(response.status==='loggedin'){window.utag_data.pc_memtype=response.memType;window.utag_data.pc_pcsid=response.think_id?response.think_id:'';logUserStatus();}})
.catch(function(err){if(err.status=='not_authorised'){window.utag_data.pc_memtype='anonymous';window.utag_data.pc_pcsid='none';logUserStatus();}});}else{log('Rampart token cookie is present. Getting user status from it.');authData=getAuth0LoginDefaults();window.utag_data.pc_memtype=authData.memtype;window.utag_data.pc_pcsid=authData.think_id;logUserStatus();}}else{log('Rampart.js not loaded.');}})();}catch(e){console.log(e)}}catch(e){console.log(e);}
(function(){var profile;var host=(window.location.hostname||'').split('.');var tld=host[host.length-3]||'';var subdomain=host[0];var env=tld.substr(-3);if(env==='sit'||subdomain=='sit'||subdomain=='staging'){profile='sit'}else if(env==='uat'||subdomain=='uat'){profile='uat';}else{profile='prod';}
var loadScript=function(url){var script=document.createElement("script");script.type="text/javascript";script.async=true;script.src=url;(document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(script);};if(profile==="sit"||profile==="uat"){loadScript('//cdn.optimizely.com/js/20352597942.js');}})();