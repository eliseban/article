/*! nca-aep.js  env: prod  date: 2023-01-17T01:16:52.169Z */
!function(){var e=function(e){window.localStorage&&window.localStorage.getItem("aep_debug")&&console.log(e)},n=function(e){for(var n=e+"=",t=document.cookie.split(";"),a=0;a<t.length;a++){for(var i=t[a];" "===i.charAt(0);)i=i.substring(1,i.length);if(0===i.indexOf(n))return i.substring(n.length,i.length)}return null};"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(e,n){"use strict";if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),a=1;a<arguments.length;a++){var i=arguments[a];if(null!=i)for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(t[o]=i[o])}return t},writable:!0,configurable:!0});var t,a,i=function(e){return window.btoa(unescape(encodeURIComponent(e)))},o=o||{},r=window.utag_data||{},s=[r.gallery_name,r.gallery_image_number,r.gallery_total_images],l=r.net_article_headline?r.net_article_headline:"gallery"===r.net_content_type&&r.gallery_name?s.join(":"):r.net_pn||r.pn?(t=r.net_pn||r.pn,(a=t.replace(/ ?\| ?/g,"|").split("|"))[a.length-1]):window.document.title,d=[r.site_short,r.net_sec1,r.net_content_type,l].join("|").toLowerCase();o={xdm:{eventType:null,web:null}};var c=function(e){var n=Object.assign({},o);return n.xdm={eventType:p?"web.webpagedetails.pageViews":"id5IdRefresh"},n.xdm.web={webPageDetails:{name:d,pageViews:{value:1}}},"id5Id"===e?(n.xdm.web.webPageDetails.URL=window.location.href||window.utag_data["dom.url"],n):n},w=!!n("yoc"),p="racenet"===r.net_site||"odds"===r.net_site||"punters"===r.net_site,u=!w,g=window.sessionStorage.getItem("aep_user_session"),_=function(e){var n={sha1:"",sha256:""};if(e){var t=function(e){var n=e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),t=decodeURIComponent(atob(n).split("").map((function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)})).join(""));return JSON.parse(t)}(e);if(t){var a="http://login.newscorpaustralia.com.au/profile",i=t[a]&&t[a].ats_hash?t[a].ats_hash.split("."):[],o=i[1]||"",r=i[0]||"";return n.sha1=o,n.sha256=r,n}}return n},m=function(t){var a,i,s=window.newskey?window.newskey.nk:null,l=n("_ncg_id_"),w=null,_=s||n("nk")||n("newskey")||l,m=(window.localStorage.getItem("aep_prev_user_optin"),window.localStorage.getItem("aep_prev_user_memtype"),window.localStorage.getItem("aep_prev_user_pcsid")),v=window.localStorage.getItem("aep_prev_user_nk"),y=window.localStorage.getItem("aep_prev_id5id"),f=!!(m&&r.pc_memtype&&r.pc_pcsid&&"not set"!==r.pc_pcsid&&"anonymous"!==r.pc_memtype&&m!=r.pc_pcsid),I=r.disable_id5id?null:t.getUserId(),b={customIdentities:{encryptedId5Id:I,newsKeyId:_},webDetails:{brandName:r.brand,siteName:r.net_site}},h={customIdentities:{newsKeyId:_},WebSdkExperienceDetails:{pageName:d,pageURL:window.location.href,subCategoryLevel1:r.net_sec1||"",subCategoryLevel2:r.net_sec2||"",subCategoryLevel3:r.net_sec3||"",subCategoryLevel4:r.net_sec4||"",subCategoryLevel5:r.net_sec5||"",subCategoryLevel6:r.net_sec6||"",categoryType:r.net_content_type,brandName:r.brand,siteName:r.net_site}};g||(window.sessionStorage.setItem("aep_user_session",1),(w=c("id5Id")).xdm._newscorpau=p?h:b,e("--- No AEP user session detected and User has opted in.Sending Encrypted ID --- "+JSON.stringify(w)),alloy("sendEvent",w)),y===I||f||!g||r.disable_id5id||((w=c(null)).xdm._newscorpau=p?h:b,e("--- ID5ID update detected, AEP sendEvent fired ---"+JSON.stringify(w)),alloy("sendEvent",w)),f&&(a="user login",(i=Object.assign({},o)).xdm={eventType:p?"web.webinteraction.linkClicks":"id5IdRefresh"},i.xdm.web={webInteraction:{linkClicks:{value:1},name:a,URL:window.location.href||window.utag_data["dom.url"],type:"other"},webPageDetails:{name:d,URL:window.location.href||window.utag_data["dom.url"]}},(w=i).xdm._newscorpau=p?h:b,e("--- User Login detected, AEP sendEvent fired --- "+JSON.stringify(w)),alloy("sendEvent",w)),v&&v!==_&&((w=c(null)).xdm._newscorpau=p?h:b,e("--- User Newskey update detected, AEP sendEvent fired --- "+JSON.stringify(w)),alloy("sendEvent",w)),window.localStorage.setItem("aep_prev_id5id",I),window.localStorage.setItem("aep_prev_user_optin",u),window.localStorage.setItem("aep_prev_user_memtype",r.pc_memtype),window.localStorage.setItem("aep_prev_user_pcsid",decodeURI(n("metrics_pcsid"))),window.localStorage.setItem("aep_prev_user_nk",_)};interval=setInterval((function(){e("--- Waiting AEP Dependencies ---");var t=window.localStorage&&window.localStorage.getItem("aep_debug");if(void 0===window.Rampart&&(r.disable_id5id=!0),r.disable_id5id)window.alloy&&window.isAlloyConfigured&&(e("--- AEP Dependencies Loaded ---"),clearInterval(interval),m());else if(window.ID5&&window.alloy&&window.isAlloyConfigured){clearInterval(interval),e("--- ID5ID Enable, AEP Dependencies Loaded --- ");var a=(window.location.href.split(".")[0].indexOf("www")>-1?window.location.href.split(".")[1]:window.location.href.split(".")[0].replace("https://","")).replace("sit","").replace("uat",""),o=!!window.location.host.split(".")[1]&&window.location.host.split(".")[0],s={site:"news"===a?"newscomau":"sn"===a?"skynews":"supercoach"===o?"supercoach":a};e("--- ID5ID Auth0 Config ---  "+JSON.stringify(s));var l=new Rampart(s),d=function(a){var o=n("rampart_token")||a,r=(window.newskey?window.newskey.nk:null)||n("nk")||n("newskey"),s=_(o).sha256,l="5="+r,d=i("1="+s+"&5="+r),c=i(l),w={partnerId:701,refreshInSeconds:28800};e("--- User Hash --- "+s),o&&s?(e("--- Rampart Token and User Hash  Detected--- Hash: "+s+" ---Rampart Token: "+o),w.pd=d,e("--- ID5ID PD Value: ---"+d)):(w.pd=c,e("--- ID5ID PD Value: ---"+c)),e("--- ID5ID Config ---"+JSON.stringify(w));var p=ID5.init(w);ID5.debug=!!t,p.onAvailable(m)};l.getToken().then((function(e){d(e)})).catch((function(e){d(null)}))}}),1e3),gcTicker=setTimeout((function(){clearInterval(interval),clearTimeout(gcTicker)}),5e3)}();